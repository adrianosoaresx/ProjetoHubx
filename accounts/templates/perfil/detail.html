{% extends 'base.html' %}
{% load i18n %}
{% block title %}{% trans "Meu Perfil" %} | Hubx{% endblock %}

{% block hero %}
  {% include '_components/hero.html' with title=_("Meu Perfil") %}
{% endblock %}

{% block content %}

<div class="card-header">
  <div class="mt-2 border-b border-[var(--border)]">
    <nav class="-mb-px flex gap-6" aria-label="Tabs">
      <button type="button" class="tab-btn py-3 text-sm font-medium border-b-2 border-transparent text-[var(--text-secondary)] data-[active=true]:border-primary data-[active=true]:text-primary" data-tab="informacoes">{% trans 'Informações' %}</button>
      {% if user.get_tipo_usuario != 'admin' %}
        <button type="button" class="tab-btn py-3 text-sm font-medium border-b-2 border-transparent text-[var(--text-secondary)] data-[active=true]:border-primary data-[active=true]:text-primary" data-tab="empresas">{% trans 'Empresas' %}</button>
        <button type="button" class="tab-btn py-3 text-sm font-medium border-b-2 border-transparent text-[var(--text-secondary)] data-[active=true]:border-primary data-[active=true]:text-primary" data-tab="nucleos">{% trans 'Núcleos' %}</button>
        <button type="button" class="tab-btn py-3 text-sm font-medium border-b-2 border-transparent text-[var(--text-secondary)] data-[active=true]:border-primary data-[active=true]:text-primary" data-tab="eventos">{% trans 'Eventos' %}</button>
      {% endif %}
    </nav>
  </div>
</div>

<div class="card-body">
  <div id="tab-panels" class="mt-6">
    <!-- Painel: Informações -->
    <div class="tab-panel" data-tab="informacoes">

        {% if user.biografia %}
          <div class="mb-6">
            <p class="text-[var(--text-primary)] italic border-l-4 border-primary pl-4">{{ user.biografia }}</p>
          </div>
        {% endif %}

        <div class="card-grid text-sm text-[var(--text-primary)]">
          <article class="card">
            <div class="card-body">
              <h4 class="font-medium mb-1">{% trans "Contato" %}</h4>
              <p>{% trans "Email" %}: {{ user.email }}</p>
              <p>{% trans "Telefone" %}: {{ user.phone_number }}</p>
              <p>{% trans "WhatsApp" %}: {{ user.whatsapp }}</p>
            </div>
          </article>
          <article class="card">
            <div class="card-body">
              <h4 class="font-medium mb-1">{% trans "Localização" %}</h4>
              <p>{{ user.endereco }}</p>
              <p>{{ user.cidade }} - {{ user.estado }}</p>
              <p>{{ user.cep }}</p>
            </div>
          </article>
          <article class="card">
            <div class="card-body">
              <h4 class="font-medium mb-1">{% trans "Redes Sociais" %}</h4>
              {% if user.redes_sociais %}
                {% for nome, link in user.redes_sociais.items %}
                  <p><a href="{{ link }}" class="text-primary hover:underline" target="_blank">{{ nome|title }}</a></p>
                {% endfor %}
              {% endif %}
            </div>
          </article>
        </div>

        <div class="mt-6 text-right">
          <a href="{% url 'accounts:informacoes_pessoais' %}" class="text-primary font-medium hover:underline">{% trans "Editar perfil" %}</a>
        </div>
    </div>

    {% if user.get_tipo_usuario != 'admin' %}
    <!-- Painel: Empresas -->
    <div class="tab-panel hidden" data-tab="empresas">
        <div class="card-grid">
        {% for empresa in empresas %}
          {% include '_components/card_empresa.html' with empresa=empresa %}
        {% empty %}
          <p class="text-sm text-[var(--text-secondary)]">{% trans "Nenhuma empresa encontrada." %}</p>
        {% endfor %}
      </div>
    </div>

    <!-- Painel: Núcleos -->
    <div class="tab-panel hidden" data-tab="nucleos">
      <div class="card-grid">
        {% for nucleo in nucleos %}
          {% include '_components/card_nucleo.html' with nucleo=nucleo %}
        {% empty %}
          <p class="text-sm text-[var(--text-secondary)]">{% trans "Nenhum núcleo encontrado." %}</p>
        {% endfor %}
      </div>
    </div>

    <!-- Painel: Eventos -->
    <div class="tab-panel hidden" data-tab="eventos">
        <div class="card-grid">
        {% for ins in inscricoes %}
          {% include '_components/card_evento.html' with evento=ins.evento %}
        {% empty %}
          <p class="text-sm text-[var(--text-secondary)]">{% trans "Nenhum evento encontrado." %}</p>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
</div>

{% endblock %}
