{% load i18n %}
{% if usuarios %}
  {% for user in usuarios %}
    <div class="w-full min-w-full flex-shrink-0 p-4 sm:p-6 lg:hidden" role="list" data-carousel-page="{{ page_number }}">
      <div
        role="listitem"
        class="h-full"
        data-membro-card
        data-membro-label="{{ user.contact_name|default:user.display_name|default:user.username }}"
        data-membro-search="{{ user.contact_name|default:'' }} {{ user.display_name|default:'' }} {{ user.username|default:'' }} {{ user.contato|default:'' }} {{ user.nome_fantasia|default:'' }} {{ user.razao_social|default:'' }} {{ user.cnpj|default:'' }}"
      >
        <div class="flex h-full flex-col gap-4">
          <div class="flex-1">
            {% if show_promote_button %}
              {% url 'membros:membro_promover_form' user.pk as promote_url %}
              {% if section %}
                {% with section_encoded=section|urlencode %}
                  {% with promote_cta_url=promote_url|add:'?section='|add:section_encoded %}
                    {% include '_components/card_usuario.html' with user=user cta_url=promote_cta_url cta_label=_('Promover') cta_classes='btn btn-secondary w-full text-center relative z-20' cta_container_classes='w-full' %}
                  {% endwith %}
                {% endwith %}
              {% else %}
                {% include '_components/card_usuario.html' with user=user cta_url=promote_url cta_label=_('Promover') cta_classes='btn btn-secondary w-full text-center relative z-20' cta_container_classes='w-full' %}
              {% endif %}
            {% else %}
              {% include '_components/card_usuario.html' with user=user %}
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  {% endfor %}

  {% for user in usuarios %}
    {% if forloop.counter0|divisibleby:3 %}
      <div class="hidden h-full min-h-full w-full min-w-full flex-shrink-0 gap-6 p-4 sm:p-6 lg:grid lg:grid-cols-3" role="list" data-carousel-page="{{ page_number }}">
    {% endif %}
        <div
          role="listitem"
          class="h-full"
          data-membro-card
          data-membro-label="{{ user.contact_name|default:user.display_name|default:user.username }}"
          data-membro-search="{{ user.contact_name|default:'' }} {{ user.display_name|default:'' }} {{ user.username|default:'' }} {{ user.contato|default:'' }} {{ user.nome_fantasia|default:'' }} {{ user.razao_social|default:'' }} {{ user.cnpj|default:'' }}"
        >
          <div class="flex h-full flex-col gap-4">
            <div class="flex-1">
              {% if show_promote_button %}
                {% url 'membros:membro_promover_form' user.pk as promote_url %}
                {% if section %}
                  {% with section_encoded=section|urlencode %}
                    {% with promote_cta_url=promote_url|add:'?section='|add:section_encoded %}
                      {% include '_components/card_usuario.html' with user=user cta_url=promote_cta_url cta_label=_('Promover') cta_classes='btn btn-secondary w-full text-center relative z-20' cta_container_classes='w-full' %}
                    {% endwith %}
                  {% endwith %}
                {% else %}
                  {% include '_components/card_usuario.html' with user=user cta_url=promote_url cta_label=_('Promover') cta_classes='btn btn-secondary w-full text-center relative z-20' cta_container_classes='w-full' %}
                {% endif %}
              {% else %}
                {% include '_components/card_usuario.html' with user=user %}
              {% endif %}
            </div>
          </div>
        </div>
        {% if forloop.last and not forloop.counter|divisibleby:3 %}
          <div class="hidden h-full opacity-0 pointer-events-none lg:block" aria-hidden="true"></div>
        {% endif %}
        {% if forloop.last and forloop.counter|add:"-1"|divisibleby:3 %}
          <div class="hidden h-full opacity-0 pointer-events-none lg:block" aria-hidden="true"></div>
        {% endif %}
    {% if forloop.counter|divisibleby:3 or forloop.last %}
      </div>
    {% endif %}
  {% endfor %}
{% else %}
  <div class="w-full min-w-full flex-shrink-0 p-4 sm:p-6" data-carousel-page="{{ page_number }}" data-carousel-empty>
    <div class="flex min-h-[12rem] items-center justify-center rounded-xl border border-dashed border-[var(--border-muted)] bg-[var(--bg-tertiary)] p-6 text-center">
      <p class="text-sm text-[var(--text-secondary)] italic">{{ empty_message|default:_('Nenhum usu√°rio encontrado.') }}</p>
    </div>
  </div>
{% endif %}
