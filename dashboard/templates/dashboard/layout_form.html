{% extends "base.html" %}
{% load i18n static widget_tweaks %}
{% block title %}{% trans "Layout" %} | Hubx{% endblock %}
{% block content %}
<main class="max-w-7xl mx-auto p-4" role="main" aria-label="{% trans 'Layout form' %}">
  <h1 class="text-2xl mb-4">{% trans "Layout" %}</h1>
  <form method="post">
    {% csrf_token %}
    {% trans "Nome" as nome_label %}
    <div class="mb-4 relative">
      {% if form.nome.errors %}
        {% render_field form.nome class="peer placeholder-transparent w-full rounded border border-neutral-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" placeholder=nome_label aria-describedby="nome_error" aria-invalid="true" %}
      {% else %}
        {% render_field form.nome class="peer placeholder-transparent w-full rounded border border-neutral-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" placeholder=nome_label aria-describedby="nome_error" %}
      {% endif %}
      <label for="{{ form.nome.id_for_label }}" class="absolute left-3 -top-2 text-xs text-neutral-700 transition-all peer-placeholder-shown:top-2 peer-placeholder-shown:text-sm peer-placeholder-shown:text-neutral-400 peer-focus:-top-2 peer-focus:text-xs peer-focus:text-primary-600">{{ nome_label }}</label>
      {% if form.nome.errors %}
        <div id="nome_error" class="text-red-600 text-xs mt-1" role="alert">{{ form.nome.errors }}</div>
      {% endif %}
    </div>
  {% if request.user.user_type == 'root' or request.user.user_type == 'admin' %}
    <div class="mb-4">
      <div class="flex items-center gap-2">
        {% if form.publico.errors %}
          {% render_field form.publico aria-invalid="true" aria-describedby="publico_error" %}
        {% else %}
          {% render_field form.publico aria-describedby="publico_error" %}
        {% endif %}
        <label for="{{ form.publico.id_for_label }}" class="text-sm">{{ form.publico.label }}</label>
      </div>
      {% if form.publico.errors %}
        <div id="publico_error" class="text-red-600 text-xs mt-1" role="alert">{{ form.publico.errors }}</div>
      {% endif %}
    </div>

    {% else %}
    <p class="mb-4 text-sm text-neutral-700">{% trans 'Apenas administradores podem publicar itens.' %}</p>
    {% endif %}
    <input type="hidden" name="layout_json" id="layout_json" value="{{ object.layout_json|default:'{}' }}">

    <button type="submit" class="btn btn-primary" aria-label="{% trans 'Salvar layout' %}">{% trans "Salvar" %}</button>
  </form>
  {% include 'dashboard/partials/metrics_list.html' %}
</main>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'dashboard/layout.bundle.js' %}"></script>
{% endblock %}
