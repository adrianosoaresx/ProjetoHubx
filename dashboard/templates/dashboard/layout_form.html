{% extends "base.html" %}
{% load i18n static widget_tweaks %}
{% block title %}{% trans "Layout" %} | Hubx{% endblock %}
{% block hero %}
  {% include '_components/hero.html' with title=_('Layout') %}
{% endblock %}

{% block content %}
  <div class="py-12 max-w-7xl mx-auto px-4">
    <div class="card">
      <div class="card-body space-y-6">
        <form method="post" class="space-y-4">
          {% csrf_token %}
          {% trans "Nome" as nome_label %}
          <div class="relative">
            {% if form.nome.errors %}
              {% render_field form.nome class="peer placeholder-transparent w-full rounded border border-[var(--border)] px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--border-focus)]" placeholder=nome_label aria-describedby="nome_error" aria-invalid="true" %}
            {% else %}
              {% render_field form.nome class="peer placeholder-transparent w-full rounded border border-[var(--border)] px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--border-focus)]" placeholder=nome_label aria-describedby="nome_error" %}
            {% endif %}
            <label for="{{ form.nome.id_for_label }}" class="absolute left-3 -top-2 text-xs text-[var(--text-secondary)] transition-all peer-placeholder-shown:top-2 peer-placeholder-shown:text-sm peer-placeholder-shown:text-[var(--text-muted)] peer-focus:-top-2 peer-focus:text-xs peer-focus:text-[var(--primary)]">{{ nome_label }}</label>
            {% if form.nome.errors %}
              <div id="nome_error" class="text-[var(--error)] text-xs mt-1" role="alert">{{ form.nome.errors }}</div>
            {% endif %}
          </div>
        {% if request.user.user_type == 'root' or request.user.user_type == 'admin' %}
          <div>
            <div class="flex items-center gap-2">
              {% if form.publico.errors %}
                {% render_field form.publico aria-invalid="true" aria-describedby="publico_error" %}
              {% else %}
                {% render_field form.publico aria-describedby="publico_error" %}
              {% endif %}
              <label for="{{ form.publico.id_for_label }}" class="text-sm text-[var(--text-secondary)]">{{ form.publico.label }}</label>
            </div>
            {% if form.publico.errors %}
              <div id="publico_error" class="text-[var(--error)] text-xs mt-1" role="alert">{{ form.publico.errors }}</div>
            {% endif %}
          </div>
        {% else %}
          <p class="text-sm text-[var(--text-secondary)]">{% trans 'Apenas administradores podem publicar itens.' %}</p>
        {% endif %}
        <input type="hidden" name="layout_json" id="layout_json" value="{{ object.layout_json|default:'{}' }}">
        <div class="flex justify-end pt-4 border-t border-[var(--border)]">
          <button type="submit" class="btn btn-primary" aria-label="{% trans 'Salvar layout' %}">{% trans "Salvar" %}</button>
        </div>
        </form>
        {% include '_partials/metrics_list.html' %}
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'dashboard/layout.bundle.js' %}"></script>
{% endblock %}
