{% extends "base.html" %}
{% load static i18n lucide_icons %}

{% block title %}{% trans "Dashboard Root" %} | Hubx{% endblock %}

{% block hero %}
  {% include '_components/hero.html' with title=_('Dashboard Root') %}
{% endblock %}

{% block content %}
<div class="container mx-auto p-6">
  <div class="max-w-7xl mx-auto">
    <div class="card">
      <div class="card-body space-y-8">
        {% include '_partials/messages.html' %}
        {% include '_components/filters_form.html' %}
        <div hx-get="{% url 'dashboard:metrics-partial' %}?{{ request.GET.urlencode }}" hx-trigger="load, every 10s" hx-target="#metrics" hx-swap="innerHTML">
          {% include '_partials/metrics_list.html' %}
        </div>
        {% with labels='["'|add:_('Usuários')|add:'","'|add:_('Eventos')|add:'","'|add:_('Posts')|add:'"]' %}
        {% include '_components/chart.html' with chart_id='root_chart' title=_('Distribuição de Métricas') labels=labels|safe data=chart_data %}
        {% endwith %}
        <section class="mb-8">
          <h2 class="text-xl font-semibold mb-4">{% trans "Status dos Serviços" %}</h2>
          <div class="card-grid gap-4">
            <div class="card">
              <div class="card-body">
                <span class="block font-medium">{% trans "Celery" %}</span>
                <span>{{ service_status.celery }}</span>
              </div>
            </div>
            <div class="card">
              <div class="card-body">
                <span class="block font-medium">{% trans "Fila de Mensagens" %}</span>
                <span>{{ service_status.fila_mensagens }}</span>
              </div>
            </div>
            <div class="card">
              <div class="card-body">
                <span class="block font-medium">{% trans "Uso de Disco" %}</span>
                <span>{{ service_status.disco }}%</span>
              </div>
            </div>
          </div>
        </section>
        <section class="mb-8">
          <h2 class="text-xl font-semibold mb-4">{% trans "Métricas de Segurança" %}</h2>
          <div class="card-grid gap-4">
            <div class="card">
              <div class="card-body">
                <span class="block font-medium">{% trans "Tentativas de Login Bloqueadas" %}</span>
                <span>{{ security_metrics.login_bloqueados }}</span>
              </div>
            </div>
          </div>
        </section>
        <section class="mb-8">
          <h2 class="text-xl font-semibold mb-4">{% trans "Organizações" %}</h2>
          <div class="card-grid gap-4">
            {% include '_partials/org_cards.html' %}
          </div>
        </section>
        <section
          id="notifications"
          hx-get="{% url 'dashboard:notificacoes-partial' %}"
          hx-trigger="load, every 20s"
          hx-target="this"
          hx-swap="innerHTML"
        ></section>
        <section class="mb-8">
          <h2 class="text-xl font-semibold mb-4">{% trans "Ações Rápidas" %}</h2>
          <div class="card-grid gap-4">
            <a href="{% url 'admin:index' %}" class="btn btn-secondary flex flex-col items-center" aria-label="{% trans 'Django Admin' %}">
              {% lucide 'wrench' class='mb-2 mx-auto w-6 h-6' %}
              <span class="block">{% trans "Django Admin" %}</span>
            </a>
            <a href="{% url 'dashboard:custom-metrics' %}" class="btn btn-secondary flex flex-col items-center" aria-label="{% trans 'Métricas Personalizadas' %}">
              {% lucide 'chart-line' class='mb-2 mx-auto w-6 h-6' %}
              <span class="block">{% trans "Métricas Personalizadas" %}</span>
            </a>
          </div>
        </section>
      </div>
    </div>
  </div>
</div>
{% endblock %}
