{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Informações para continuar a inscrição" %}{% endblock %}

{% block content %}
  <section class="mx-auto max-w-4xl space-y-6 px-4 py-8">
    <article class="card">
      <div class="card-header flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
        <div>
          <p class="text-sm text-[var(--text-secondary)]">{% trans "Convite" %}</p>
          <h1 class="text-2xl font-semibold text-[var(--text-primary)]">{{ evento.titulo }}</h1>
          <p class="text-sm text-[var(--text-secondary)]">{{ evento.organizacao|default:_('Evento') }}</p>
        </div>
        <div class="flex flex-col items-end gap-2 md:flex-row md:items-center">
          <div class="flex gap-2">
            {% if share_url %}
              <button
                type="button"
                class="btn btn-secondary"
                data-copy-link="{{ share_url }}"
                data-copy-success="{% trans 'Link copiado!' %}"
              >
                {% trans "Copiar link" %}
              </button>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="card-body space-y-4">
        <h2 class="text-xl font-semibold text-[var(--text-primary)]">{% trans "Como continuar" %}</h2>
        <p class="text-sm text-[var(--text-secondary)]">
          {% blocktrans with email=email %}
            Enviamos um e-mail para <strong class="font-semibold text-[var(--text-primary)]">{{ email }}</strong> com o link de confirmação.
            Acesse sua caixa de entrada e siga as orientações para concluir a inscrição no evento.
          {% endblocktrans %}
        </p>
        <div class="space-y-2 rounded-lg bg-[var(--bg-muted)] px-4 py-3">
          <p class="text-sm font-medium text-[var(--text-primary)]">{% trans "Dicas rápidas" %}</p>
          <ul class="list-disc space-y-1 pl-5 text-sm text-[var(--text-secondary)]">
            <li>{% trans "Verifique também as pastas de spam ou promoções." %}</li>
            <li>{% trans "O link do e-mail é o único caminho para finalizar sua inscrição." %}</li>
            <li>{% trans "Caso não receba, aguarde alguns minutos e tente reenviar a partir do convite." %}</li>
          </ul>
        </div>
      </div>

      <div class="flex flex-col gap-3 border-t border-[var(--border)] px-6 py-4 md:flex-row md:items-center md:justify-end">
        <a href="{{ share_url|default:request.path }}" class="btn btn-secondary">{% trans "Voltar ao convite" %}</a>
      </div>
    </article>
  </section>
{% endblock %}

{% block scripts %}
  {{ block.super }}
  <script>
    (function () {
      const copyButton = document.querySelector('[data-copy-link]');
      if (!copyButton || !navigator.clipboard) {
        return;
      }

      const originalText = copyButton.textContent.trim();
      const successText = copyButton.dataset.copySuccess || originalText;

      copyButton.addEventListener('click', async () => {
        const link = copyButton.getAttribute('data-copy-link');
        try {
          await navigator.clipboard.writeText(link);
          copyButton.textContent = successText;
          copyButton.disabled = true;
          setTimeout(() => {
            copyButton.textContent = originalText;
            copyButton.disabled = false;
          }, 1500);
        } catch (err) {
          console.error('Erro ao copiar link do convite', err);
        }
      });
    })();
  </script>
{% endblock %}
