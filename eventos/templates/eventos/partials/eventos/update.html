{% load i18n widget_tweaks %}
{% include "eventos/partials/_painel_hero_oob.html" with painel_hero_template='_components/hero_eventos_detail.html' evento=object %}
<section class="max-w-screen-xl mx-auto pt-8 px-6 lg:px-8">
  <h1 class="text-2xl font-bold text-[var(--text-primary)] mb-6">{% trans "Editar Evento" %}</h1>

  <form method="post" enctype="multipart/form-data" class="bg-[var(--bg-secondary)] border border-[var(--border)] rounded-2xl card-sm p-6 space-y-6">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-3">
      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.titulo %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.descricao %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.data_inicio %}
      </div>
      <div>
        {% include '_forms/field.html' with field=form.data_fim %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.local %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.cidade %}
      </div>
      <div>
        {% include '_forms/field.html' with field=form.estado %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.cep %}
      </div>
      <div>
        {% include '_forms/field.html' with field=form.coordenador %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.status %}
      </div>
      <div>
        {% include '_forms/field.html' with field=form.publico_alvo %}
      </div>

      <div id="nucleo-field-container" class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.nucleo %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.numero_convidados %}
      </div>
      <div>
        {% include '_forms/field.html' with field=form.participantes_maximo %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.valor_ingresso %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.cronograma %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.informacoes_adicionais %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.briefing %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.parcerias %}
      </div>

      <div>
        {% include '_forms/field.html' with field=form.contato_nome %}
      </div>
      <div>
        {% include '_forms/field.html' with field=form.contato_email %}
      </div>

      <div class="md:col-span-2 xl:col-span-3">
        {% include '_forms/field.html' with field=form.contato_whatsapp %}
      </div>

      <div>
        {% if object.avatar %}
          <img src="{{ object.avatar.url }}" alt="{{ form.avatar.label }}" class="w-32 h-32 object-cover mb-2" loading="lazy">
        {% endif %}
        {% include '_forms/field.html' with field=form.avatar|attr:'accept:image/*' %}
      </div>

      <div>
        {% if object.cover %}
          <img src="{{ object.cover.url }}" alt="{{ form.cover.label }}" class="w-48 h-32 object-cover mb-2 rounded" loading="lazy">
        {% endif %}
        {% include '_forms/field.html' with field=form.cover|attr:'accept:image/*' %}
      </div>
    </div>

    <div class="flex justify-end gap-3 pt-4 border-t border-[var(--border)]">
      <a href="{% url 'eventos:calendario' %}" class="btn btn-secondary" aria-label="{% trans 'Voltar' %}">{% trans "Voltar" %}</a>
      <button type="submit" class="btn btn-primary" aria-label="{% trans 'Salvar' %}">{% trans "Salvar" %}</button>
    </div>
  </form>

</section>

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const publicoAlvoSelect = document.getElementById('id_publico_alvo');
    const nucleoInput = document.getElementById('id_nucleo');
    const nucleoFieldWrapper = document.getElementById('nucleo-field-container');

    const toggleNucleoField = () => {
      if (!publicoAlvoSelect || !nucleoInput || !nucleoFieldWrapper) {
        return;
      }

      if (publicoAlvoSelect.value === '1') {
        nucleoFieldWrapper.classList.remove('hidden');
      } else {
        nucleoFieldWrapper.classList.add('hidden');
        nucleoInput.value = '';
      }
    };

    toggleNucleoField();

    if (publicoAlvoSelect) {
      publicoAlvoSelect.addEventListener('change', toggleNucleoField);
    }
  });
</script>
{% endblock %}
