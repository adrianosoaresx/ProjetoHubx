{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Briefings" %} | Hubx{% endblock %}

{% block hero %}
  {% include '_components/hero.html' with title=_('Briefings de Eventos') %}
{% endblock %}

{% block content %}
<div id="briefing-container" class="container mx-auto p-6">
  <div class="card">
    <div class="card-header flex items-center justify-between">
      <a href="{% url 'eventos:briefing_criar' %}" class="btn-primary">{% trans "Novo Briefing" %}</a>
    </div>
    <div class="card-body">
      {% if messages %}
        <div class="mb-4 space-y-2">
          {% for message in messages %}
            <p class="rounded-xl px-4 py-2 text-sm {% if 'success' in message.tags %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %}">{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}

      <form hx-get="{% url 'eventos:briefing_list' %}" hx-target="#briefing-container" hx-push-url="true" class="mb-6 flex gap-2">
        <input type="text" name="q" value="{{ request.GET.q }}" placeholder="{% trans 'Buscar por evento' %}" class="w-full rounded-md border-gray-300 px-3 py-2" />
        <button type="submit" class="btn-primary">{% trans "Filtrar" %}</button>
      </form>

      <div class="overflow-x-auto bg-[var(--bg-secondary)] border border-[var(--border)] rounded-2xl shadow-sm">
        <table class="min-w-full divide-y divide-neutral-200 table-auto text-sm">
          <thead class="bg-neutral-50">
            <tr>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Evento" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Objetivos" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Público Alvo" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Requisitos Técnicos" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Cronograma Resumido" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Conteúdo Programático" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Observações" %}</th>
              <th class="px-4 py-2 text-left font-semibold text-neutral-700">{% trans "Ações" %}</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-neutral-200">
            {% for briefing in briefings %}
              <tr>
                <td class="px-4 py-2">{{ briefing.evento }}</td>
                <td class="px-4 py-2">{{ briefing.objetivos }}</td>
                <td class="px-4 py-2">{{ briefing.publico_alvo }}</td>
                <td class="px-4 py-2">{{ briefing.requisitos_tecnicos }}</td>
                <td class="px-4 py-2">{{ briefing.cronograma_resumido }}</td>
                <td class="px-4 py-2">{{ briefing.conteudo_programatico }}</td>
                <td class="px-4 py-2">{{ briefing.observacoes }}</td>
                <td class="px-4 py-2 space-x-2">
                  <a href="{% url 'eventos:briefing_editar' briefing.pk %}" class="btn-secondary">{% trans "Editar" %}</a>
                  <form method="post" action="{% url 'eventos:briefing_status' briefing.pk 'orcamentado' %}" class="inline space-x-1">
                    {% csrf_token %}
                    <input type="datetime-local" name="prazo_limite_resposta" required class="rounded-md border-gray-300 px-2 py-1 text-xs" />
                    <button type="submit" class="btn-secondary">{% trans "Orçar" %}</button>
                  </form>
                  <form method="post" action="{% url 'eventos:briefing_status' briefing.pk 'aprovado' %}" class="inline">
                    {% csrf_token %}
                    <button type="submit" class="btn-primary">{% trans "Aprovar" %}</button>
                  </form>
                  <form method="post" action="{% url 'eventos:briefing_status' briefing.pk 'recusado' %}" class="inline space-x-1">
                    {% csrf_token %}
                    <input type="text" name="motivo_recusa" placeholder="{% trans 'Motivo' %}" required class="rounded-md border-gray-300 px-2 py-1 text-xs" />
                    <button type="submit" class="btn-secondary">{% trans "Recusar" %}</button>
                  </form>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="8" class="px-4 py-4 text-center text-neutral-500">{% trans "Nenhum briefing encontrado." %}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <footer class="mt-6 text-right">
        <a href="{% url 'eventos:calendario' %}" class="text-sm text-blue-600 hover:underline">{% trans "Voltar aos eventos" %}</a>
      </footer>
    </div>
  </div>
</div>
{% endblock %}
