{% load widget_tweaks i18n %}

<form
  method="post"
  hx-post="{% url 'configuracoes:configuracoes' %}?tab=seguranca"
  hx-target="#content"
  class="space-y-4"
>
  {% csrf_token %}
  {% if seguranca_form.non_field_errors %}
    <ul class="errorlist bg-[var(--bg-secondary)] text-[var(--danger-text)] border border-[var(--danger-border)] rounded-2xl p-4">
      {% for err in seguranca_form.non_field_errors %}<li>{{ err }}</li>{% endfor %}
    </ul>
  {% endif %}
  <input type="hidden" name="tab" value="seguranca" />
  <fieldset class="space-y-4">
    <legend class="sr-only">{% trans 'Segurança da conta' %}</legend>
    {% for field in seguranca_form %}
      {% include '_forms/field.html' with field=field %}
    {% endfor %}
  </fieldset>
  <div class="text-right pt-2">
    <button
      type="submit"
      aria-label="{% trans 'Salvar Alterações' %}"
      class="btn btn-primary"
    >
      {% trans 'Salvar Alterações' %}
    </button>
  </div>
</form>

<div class="mt-6 border-t border-[var(--border)] pt-4">
  <h2 class="text-lg font-semibold mb-2">
    {% trans 'Autenticação em duas etapas' %}
  </h2>
  {% if two_factor_enabled %}
    <p class="text-sm mb-4">
      {% trans '2FA está habilitado para sua conta.' %}
    </p>
    <a
      href="{% url 'tokens:desativar_2fa' %}"
      class="btn btn-secondary text-[var(--error)]"
    >
      {% trans 'Desativar 2FA' %}
    </a>
  {% else %}
    <p class="text-sm mb-4">
      {% trans '2FA não está habilitado.' %}
    </p>
    <a
      href="{% url 'tokens:ativar_2fa' %}"
      class="btn btn-primary"
    >
      {% trans 'Ativar 2FA' %}
    </a>
  {% endif %}
</div>