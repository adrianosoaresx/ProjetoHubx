{% extends "base.html" %}
{% load i18n widget_tweaks %}

{% block content %}
<div class="max-w-3xl mx-auto py-10 space-y-6">
  <div class="bg-[var(--bg-secondary)] shadow rounded-xl p-6 space-y-2 border border-[var(--border)]">
    <p class="text-xs uppercase font-semibold text-[var(--text-muted)]">{% trans "Pagamento" %}</p>
    <h1 class="text-2xl font-bold text-[var(--text-primary)]">{% trans "Pagamento via Pix" %}</h1>
    <p class="text-[var(--text-secondary)]">{% trans "Finalize sua cobran√ßa Pix no Mercado Pago." %}</p>
  </div>

  <form
    method="post"
    action="{% url 'pagamentos:pix-checkout' %}"
    class="bg-[var(--bg-secondary)] shadow rounded-xl p-6 space-y-5 border border-[var(--border)]"
  >
    {% csrf_token %}
    {{ form.organizacao_id }}
    {{ form.inscricao_uuid }}
    {{ form.metodo.as_hidden }}
    {{ form.token_cartao.as_hidden }}
    {{ form.payment_method_id.as_hidden }}
    {{ form.vencimento.as_hidden }}
    {{ form.parcelas.as_hidden }}

    {% if form.errors or form.non_field_errors %}
      <div class="rounded-lg border border-red-300 bg-red-50 p-4 dark:border-red-500/40 dark:bg-red-500/10">
        <p class="font-semibold text-red-700 mb-2 dark:text-red-200">{% trans "Corrija os erros abaixo:" %}</p>
        {{ form.non_field_errors }}
        <ul class="list-disc list-inside text-red-700 text-sm dark:text-red-200">
          {% for field in form %}
            {% if field.errors %}
              <li><span class="font-semibold">{{ field.label }}:</span> {{ field.errors|join:"; " }}</li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <div class="space-y-6">
      <div class="space-y-2">
        <label class="text-sm font-medium text-[var(--text-secondary)]" for="id_valor">{% trans "Valor" %}</label>
        {{ form.valor|add_class:"mt-1 w-full rounded-lg border-[var(--border)] bg-[var(--bg-primary)] text-[var(--text-primary)] placeholder:text-[var(--text-muted)] shadow-sm focus:border-[var(--border-focus)] focus:ring-[var(--border-focus)]" }}
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="space-y-2">
          <label class="text-sm font-medium text-[var(--text-secondary)]" for="id_nome">{% trans "Nome completo" %}</label>
          {{ form.nome|add_class:"mt-1 w-full rounded-lg border-[var(--border)] bg-[var(--bg-primary)] text-[var(--text-primary)] placeholder:text-[var(--text-muted)] shadow-sm focus:border-[var(--border-focus)] focus:ring-[var(--border-focus)]" }}
        </div>
        <div class="space-y-2">
          <label class="text-sm font-medium text-[var(--text-secondary)]" for="id_email">{% trans "E-mail" %}</label>
          {{ form.email|add_class:"mt-1 w-full rounded-lg border-[var(--border)] bg-[var(--bg-primary)] text-[var(--text-primary)] placeholder:text-[var(--text-muted)] shadow-sm focus:border-[var(--border-focus)] focus:ring-[var(--border-focus)]" }}
        </div>
        <div class="space-y-2">
          <label class="text-sm font-medium text-[var(--text-secondary)]" for="id_documento">{% trans "Documento" %}</label>
          {{ form.documento|add_class:"mt-1 w-full rounded-lg border-[var(--border)] bg-[var(--bg-primary)] text-[var(--text-primary)] placeholder:text-[var(--text-muted)] shadow-sm focus:border-[var(--border-focus)] focus:ring-[var(--border-focus)]" }}
        </div>
      </div>
    </div>

    <div class="flex justify-end">
      <button
        type="submit"
        class="w-full rounded-lg bg-[var(--primary)] px-4 py-3 text-sm font-semibold text-white shadow-sm transition hover:bg-[var(--primary-strong)] focus:outline-none focus:ring-2 focus:ring-[var(--border-focus)]"
      >
        {% trans "Gerar pagamento Pix" %}
      </button>
    </div>
  </form>
</div>
{% endblock %}
