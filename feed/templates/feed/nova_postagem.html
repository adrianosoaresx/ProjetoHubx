{% extends "base.html" %}
{% load static i18n %}

{% block title %}{% trans "Nova Postagem" %} - Hubx{% endblock %}

{% block content %}
<section class="max-w-2xl mx-auto px-4 py-10">

  <!-- Cabeçalho -->
  <div class="mb-6 flex items-center gap-4">
    <a href="{% url 'feed:listar' %}" class="inline-flex items-center text-sm px-4 py-2 rounded-xl border border-neutral-300 text-neutral-700 hover:bg-neutral-100 focus:outline-none focus:ring-2 focus:ring-indigo-500" aria-label="{% trans 'Voltar' %}">
      <svg class="mr-2" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15,18 9,12 15,6"/>
      </svg>
      {% trans "Voltar" %}
    </a>
    <div>
      <h1 class="text-2xl font-bold text-neutral-900">{% trans "Nova Postagem" %}</h1>
      <p class="text-sm text-neutral-600">{% trans "Compartilhe algo com sua comunidade" %}</p>
    </div>
  </div>

  <!-- Formulário -->
  <form method="post"
        hx-post="{% url 'feed:nova_postagem' %}"
        hx-encoding="multipart/form-data"
        enctype="multipart/form-data"
        class="post-form bg-white border border-neutral-200 rounded-2xl shadow-sm p-6 space-y-6">
    {% csrf_token %}

    <!-- Conteúdo -->
    <div>
      <label for="{{ form.conteudo.id_for_label }}" class="block text-sm font-medium text-neutral-700">
        {{ form.conteudo.label }}
      </label>
      <textarea
        id="{{ form.conteudo.id_for_label }}"
        name="{{ form.conteudo.name }}"
        class="mt-1 block w-full rounded-xl border border-neutral-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm"
          placeholder="{% trans 'O que você gostaria de compartilhar?' %}"
        rows="6"
      >{{ form.conteudo.value|default_if_none:"" }}</textarea>
      <span id="char-count"></span>
      {% if form.conteudo.errors %}
        <p class="text-red-500 text-xs mt-1">{{ form.conteudo.errors }}</p>
      {% endif %}
        <p class="text-sm text-neutral-500 mt-1">{% trans "Compartilhe ideias, atualizações ou conteúdos com sua rede." %}</p>
    </div>

    <div class="mb-4">
        <label for="id_tipo_feed" class="font-semibold mb-1 block">{% trans "Tipo de Feed" %}</label>
      {{ form.tipo_feed|as_widget }}
    </div>
    <div class="mb-4">
        <label for="id_nucleo" class="font-semibold mb-1 block">{% trans "Núcleo" %}</label>
      {{ form.nucleo|as_widget }}
    </div>
    <div class="mb-4">
        <label for="id_evento" class="font-semibold mb-1 block">{% trans "Evento" %}</label>
      {{ form.evento|as_widget }}
    </div>
    <div class="mb-4">
        <label for="{{ form.tags.id_for_label }}" class="font-semibold mb-1 block">{% trans "Tags" %}</label>
      {{ form.tags|as_widget }}
    </div>

    <!-- Arquivo -->
    <div>
        <label for="id_file" class="block text-sm font-medium text-neutral-700">{% trans "Arquivo (imagem, vídeo ou PDF)" %}</label>
      <input type="file" id="id_file" name="arquivo" accept="image/*,video/*,.pdf"
             class="mt-2 block w-full text-sm text-neutral-600 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-neutral-100 file:text-neutral-700 hover:file:bg-neutral-200">
      <span class="file-text">Nenhum arquivo selecionado</span>
      {% if form.image.errors or form.pdf.errors %}
        <p class="text-red-500 text-xs mt-1">
          {{ form.image.errors }} {{ form.pdf.errors }}
        </p>
      {% endif %}
    </div>

    <!-- Ações -->
    <div class="flex justify-end gap-4 mt-6">
      <button type="submit"
              class="inline-flex items-center gap-2 rounded bg-emerald-600 px-5 py-2 text-white hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500" aria-label="{% trans 'Salvar' %}">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5">
          <path fill-rule="evenodd" d="M16.704 5.29a1 1 0 0 1 0 1.42l-7.5 7.5a1 1 0 0 1-1.42 0l-3.5-3.5a1 1 0 1 1 1.42-1.42l2.79 2.79 6.79-6.79a1 1 0 0 1 1.42 0Z" clip-rule="evenodd" />
        </svg>
        {% trans "Salvar" %}
      </button>
      <a href="{% url 'feed:listar' %}"
         class="inline-flex items-center gap-2 rounded border border-neutral-300 px-5 py-2 hover:bg-neutral-100 focus:outline-none focus:ring-2 focus:ring-neutral-500" aria-label="{% trans 'Cancelar' %}">
        {% trans "Cancelar" %}
      </a>
    </div>
  </form>
</section>

<script src="{% static 'feed/js/feed.js' %}"></script>
{% endblock %}
