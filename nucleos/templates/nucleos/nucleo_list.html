{% extends 'base.html' %}
{% load i18n lucide_icons %}

{% block title %}{{ list_title|default_if_none:_('Núcleos')|default:_('Núcleos') }}{% endblock %}

{% block hero %}
{% include list_hero_template|default_if_none:'_components/hero_nucleo.html'|default:'_components/hero_nucleo.html' with title=list_title|default_if_none:_('Núcleos')|default:_('Núcleos') action_template=list_hero_action_template|default_if_none:'nucleos/hero_actions_nucleo.html'|default:'nucleos/hero_actions_nucleo.html' total_nucleos=total_nucleos total_membros=total_membros_org total_eventos=total_eventos_org total_eventos_ativos=total_eventos_ativos_org total_eventos_concluidos=total_eventos_concluidos_org %}

{% endblock %}

{% block content %}

  <div class="space-y-6">
    <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
      <h2 class="text-xl font-semibold">{{ list_title|default_if_none:_('Núcleos')|default:_('Núcleos') }}</h2>
      <div class="flex flex-wrap items-center gap-3">
        {% block list_actions %}{% endblock %}
      </div>
    </div>

    {% with card_template=list_card_template|default_if_none:'_components/card_nucleo.html'|default:'_components/card_nucleo.html' %}
      {% with card_item_name=item_context_name|default_if_none:'nucleo'|default:'nucleo' %}
        <div class="space-y-6">
          {% for section in nucleo_sections %}
            <details class="card group" data-nucleos-section="{{ section.key }}">
              <summary class="card-header flex items-center justify-between gap-4 cursor-pointer">
                <div class="flex items-start gap-3">
                  <span class="{{ section.icon_classes }}">
                    {% lucide section.icon class='h-6 w-6' aria_hidden='true' %}
                  </span>
                  <div class="space-y-1">
                    <p class="text-xl font-semibold">{{ section.title }}</p>
                    <p class="text-sm text-[var(--text-secondary)]">
                      {% blocktrans count count=section.total %}
                        {{ count }} núcleo no total
                      {% plural %}
                        {{ count }} núcleos no total
                      {% endblocktrans %}
                    </p>
                  </div>
                </div>
                <span class="text-[var(--text-secondary)] transition-transform duration-200 group-open:-rotate-180">
                  {% lucide 'chevron-down' class='w-5 h-5' aria_hidden='true' %}
                </span>
              </summary>
              <div class="card-body">
                {% if section.items %}
                  <div role="list" aria-label="{{ section.aria_label }}" class="grid gap-4 md:grid-cols-2">
                    {% for nucleo in section.items %}
                      <div role="listitem">
                        {% include card_template with item=nucleo nucleo=nucleo item_context_name=card_item_name %}
                      </div>
                    {% endfor %}
                  </div>
                {% else %}
                  <p class="text-sm text-[var(--text-secondary)] italic">{{ section.empty_message }}</p>
                {% endif %}
              </div>
            </details>
          {% endfor %}
        </div>
      {% endwith %}
    {% endwith %}

    {% include '_partials/pagination.html' with page_obj=page_obj querystring=querystring %}
    {% block list_footer %}{% endblock %}
  </div>

  <div id="modal" role="presentation" aria-live="polite"></div>
{% endblock %}
